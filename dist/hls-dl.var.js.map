{"version":3,"sources":["webpack://hlsDl/./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack://hlsDl/./node_modules/@babel/runtime/helpers/extends.js","webpack://hlsDl/./node_modules/@babel/runtime/helpers/inheritsLoose.js","webpack://hlsDl/./node_modules/@videojs/vhs-utils/dist/decode-b64-to-uint8-array.js","webpack://hlsDl/./node_modules/@videojs/vhs-utils/dist/stream.js","webpack://hlsDl/./node_modules/global/window.js","webpack://hlsDl/./node_modules/m3u8-parser/dist/m3u8-parser.es.js","webpack://hlsDl/./src/index.ts","webpack://hlsDl/webpack/bootstrap","webpack://hlsDl/webpack/startup","webpack://hlsDl/webpack/runtime/compat get default export","webpack://hlsDl/webpack/runtime/define property getters","webpack://hlsDl/webpack/runtime/global","webpack://hlsDl/webpack/runtime/hasOwnProperty shorthand","webpack://hlsDl/webpack/runtime/make namespace object"],"names":["module","exports","self","ReferenceError","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","subClass","superClass","create","constructor","__proto__","_interopDefaultLegacy","e","window__default","b64Text","s","decodedString","atob","Buffer","from","toString","array","Uint8Array","charCodeAt","Stream","listeners","_proto","on","type","listener","push","off","index","indexOf","slice","splice","trigger","callbacks","args","Array","_length","_i","dispose","pipe","destination","data","win","window","g","LineStream","_Stream","_this","buffer","nextNewline","substring","parseAttributes","attributes","attr","attrs","split","RegExp","result","exec","replace","ParseStream","customParsers","tagMappers","line","match","event","_this2","trim","reduce","acc","mapper","mappedLine","concat","forEach","newLine","tagType","duration","parseFloat","title","parseInt","version","number","playlistType","offset","allowed","test","URI","uri","BYTERANGE","_attributes$BYTERANGE","byterange","RESOLUTION","resolution","width","height","BANDWIDTH","dateTimeString","dateTimeObject","Date","IV","toLowerCase","Uint32Array","PRECISE","text","addParser","_ref","_this3","expression","customType","dataParser","segment","addTagMapper","_ref2","map","Parser","lineStream","parseStream","currentMap","_key","uris","currentUri","noop","defaultMediaGroups","currentTimeline","manifest","allowCache","discontinuityStarts","segments","lastByterangeEnd","entry","mediaGroup","rendition","tag","message","endlist","endList","inf","mediaSequence","discontinuitySequence","METHOD","KEYFORMAT","KEYID","contentProtection","schemeIdUri","keyId","pssh","method","iv","isFinite","playlist","playlists","mediaGroups","media","TYPE","NAME","mediaGroupType","default","DEFAULT","autoselect","AUTOSELECT","LANGUAGE","language","instreamId","CHARACTERISTICS","characteristics","FORCED","forced","discontinuity","targetduration","targetDuration","totalduration","totalDuration","start","isNaN","timeOffset","precise","cueOut","cueOutCont","cueIn","timeline","comment","custom","chunk","end","options","download","url","fetch","then","response","ok","Error","statusText","m3u8","parsed","parser","parseM3U8","urls","promises","headers","get","arrayBuffer","Promise","all","Blob","downloadToFile","filename","blob","URL","webkitURL","u","createObjectURL","a","document","createElement","style","display","href","body","appendChild","click","revokeObjectURL","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","n","getter","__esModule","d","definition","o","defineProperty","enumerable","globalThis","Function","obj","prop","r","Symbol","toStringTag","value"],"mappings":"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","file":"hls-dl.var.js","sourcesContent":["function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nmodule.exports = _inheritsLoose;","/*! @name @videojs/vhs-utils @version 2.2.1 @license MIT */\n'use strict';\n\nvar window = require('global/window');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar window__default = /*#__PURE__*/_interopDefaultLegacy(window);\n\nvar atob = function atob(s) {\n  return window__default['default'].atob ? window__default['default'].atob(s) : Buffer.from(s, 'base64').toString('binary');\n};\n\nfunction decodeB64ToUint8Array(b64Text) {\n  var decodedString = atob(b64Text);\n  var array = new Uint8Array(decodedString.length);\n\n  for (var i = 0; i < decodedString.length; i++) {\n    array[i] = decodedString.charCodeAt(i);\n  }\n\n  return array;\n}\n\nmodule.exports = decodeB64ToUint8Array;\n","/*! @name @videojs/vhs-utils @version 2.2.1 @license MIT */\n'use strict';\n\n/**\n * @file stream.js\n */\n\n/**\n * A lightweight readable stream implemention that handles event dispatching.\n *\n * @class Stream\n */\nvar Stream = /*#__PURE__*/function () {\n  function Stream() {\n    this.listeners = {};\n  }\n  /**\n   * Add a listener for a specified event type.\n   *\n   * @param {string} type the event name\n   * @param {Function} listener the callback to be invoked when an event of\n   * the specified type occurs\n   */\n\n\n  var _proto = Stream.prototype;\n\n  _proto.on = function on(type, listener) {\n    if (!this.listeners[type]) {\n      this.listeners[type] = [];\n    }\n\n    this.listeners[type].push(listener);\n  }\n  /**\n   * Remove a listener for a specified event type.\n   *\n   * @param {string} type the event name\n   * @param {Function} listener  a function previously registered for this\n   * type of event through `on`\n   * @return {boolean} if we could turn it off or not\n   */\n  ;\n\n  _proto.off = function off(type, listener) {\n    if (!this.listeners[type]) {\n      return false;\n    }\n\n    var index = this.listeners[type].indexOf(listener); // TODO: which is better?\n    // In Video.js we slice listener functions\n    // on trigger so that it does not mess up the order\n    // while we loop through.\n    //\n    // Here we slice on off so that the loop in trigger\n    // can continue using it's old reference to loop without\n    // messing up the order.\n\n    this.listeners[type] = this.listeners[type].slice(0);\n    this.listeners[type].splice(index, 1);\n    return index > -1;\n  }\n  /**\n   * Trigger an event of the specified type on this stream. Any additional\n   * arguments to this function are passed as parameters to event listeners.\n   *\n   * @param {string} type the event name\n   */\n  ;\n\n  _proto.trigger = function trigger(type) {\n    var callbacks = this.listeners[type];\n\n    if (!callbacks) {\n      return;\n    } // Slicing the arguments on every invocation of this method\n    // can add a significant amount of overhead. Avoid the\n    // intermediate object creation for the common case of a\n    // single callback argument\n\n\n    if (arguments.length === 2) {\n      var length = callbacks.length;\n\n      for (var i = 0; i < length; ++i) {\n        callbacks[i].call(this, arguments[1]);\n      }\n    } else {\n      var args = Array.prototype.slice.call(arguments, 1);\n      var _length = callbacks.length;\n\n      for (var _i = 0; _i < _length; ++_i) {\n        callbacks[_i].apply(this, args);\n      }\n    }\n  }\n  /**\n   * Destroys the stream and cleans up.\n   */\n  ;\n\n  _proto.dispose = function dispose() {\n    this.listeners = {};\n  }\n  /**\n   * Forwards all `data` events on this stream to the destination stream. The\n   * destination stream should provide a method `push` to receive the data\n   * events as they arrive.\n   *\n   * @param {Stream} destination the stream that will receive all `data` events\n   * @see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options\n   */\n  ;\n\n  _proto.pipe = function pipe(destination) {\n    this.on('data', function (data) {\n      destination.push(data);\n    });\n  };\n\n  return Stream;\n}();\n\nmodule.exports = Stream;\n","var win;\n\nif (typeof window !== \"undefined\") {\n    win = window;\n} else if (typeof global !== \"undefined\") {\n    win = global;\n} else if (typeof self !== \"undefined\"){\n    win = self;\n} else {\n    win = {};\n}\n\nmodule.exports = win;\n","/*! @name m3u8-parser @version 4.5.0 @license Apache-2.0 */\nimport _inheritsLoose from '@babel/runtime/helpers/inheritsLoose';\nimport Stream from '@videojs/vhs-utils/dist/stream.js';\nimport _extends from '@babel/runtime/helpers/extends';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport decodeB64ToUint8Array from '@videojs/vhs-utils/dist/decode-b64-to-uint8-array.js';\n\n/**\n * A stream that buffers string input and generates a `data` event for each\n * line.\n *\n * @class LineStream\n * @extends Stream\n */\n\nvar LineStream =\n/*#__PURE__*/\nfunction (_Stream) {\n  _inheritsLoose(LineStream, _Stream);\n\n  function LineStream() {\n    var _this;\n\n    _this = _Stream.call(this) || this;\n    _this.buffer = '';\n    return _this;\n  }\n  /**\n   * Add new data to be parsed.\n   *\n   * @param {string} data the text to process\n   */\n\n\n  var _proto = LineStream.prototype;\n\n  _proto.push = function push(data) {\n    var nextNewline;\n    this.buffer += data;\n    nextNewline = this.buffer.indexOf('\\n');\n\n    for (; nextNewline > -1; nextNewline = this.buffer.indexOf('\\n')) {\n      this.trigger('data', this.buffer.substring(0, nextNewline));\n      this.buffer = this.buffer.substring(nextNewline + 1);\n    }\n  };\n\n  return LineStream;\n}(Stream);\n\n/**\n * \"forgiving\" attribute list psuedo-grammar:\n * attributes -> keyvalue (',' keyvalue)*\n * keyvalue   -> key '=' value\n * key        -> [^=]*\n * value      -> '\"' [^\"]* '\"' | [^,]*\n */\n\nvar attributeSeparator = function attributeSeparator() {\n  var key = '[^=]*';\n  var value = '\"[^\"]*\"|[^,]*';\n  var keyvalue = '(?:' + key + ')=(?:' + value + ')';\n  return new RegExp('(?:^|,)(' + keyvalue + ')');\n};\n/**\n * Parse attributes from a line given the separator\n *\n * @param {string} attributes the attribute line to parse\n */\n\n\nvar parseAttributes = function parseAttributes(attributes) {\n  // split the string using attributes as the separator\n  var attrs = attributes.split(attributeSeparator());\n  var result = {};\n  var i = attrs.length;\n  var attr;\n\n  while (i--) {\n    // filter out unmatched portions of the string\n    if (attrs[i] === '') {\n      continue;\n    } // split the key and value\n\n\n    attr = /([^=]*)=(.*)/.exec(attrs[i]).slice(1); // trim whitespace and remove optional quotes around the value\n\n    attr[0] = attr[0].replace(/^\\s+|\\s+$/g, '');\n    attr[1] = attr[1].replace(/^\\s+|\\s+$/g, '');\n    attr[1] = attr[1].replace(/^['\"](.*)['\"]$/g, '$1');\n    result[attr[0]] = attr[1];\n  }\n\n  return result;\n};\n/**\n * A line-level M3U8 parser event stream. It expects to receive input one\n * line at a time and performs a context-free parse of its contents. A stream\n * interpretation of a manifest can be useful if the manifest is expected to\n * be too large to fit comfortably into memory or the entirety of the input\n * is not immediately available. Otherwise, it's probably much easier to work\n * with a regular `Parser` object.\n *\n * Produces `data` events with an object that captures the parser's\n * interpretation of the input. That object has a property `tag` that is one\n * of `uri`, `comment`, or `tag`. URIs only have a single additional\n * property, `line`, which captures the entirety of the input without\n * interpretation. Comments similarly have a single additional property\n * `text` which is the input without the leading `#`.\n *\n * Tags always have a property `tagType` which is the lower-cased version of\n * the M3U8 directive without the `#EXT` or `#EXT-X-` prefix. For instance,\n * `#EXT-X-MEDIA-SEQUENCE` becomes `media-sequence` when parsed. Unrecognized\n * tags are given the tag type `unknown` and a single additional property\n * `data` with the remainder of the input.\n *\n * @class ParseStream\n * @extends Stream\n */\n\n\nvar ParseStream =\n/*#__PURE__*/\nfunction (_Stream) {\n  _inheritsLoose(ParseStream, _Stream);\n\n  function ParseStream() {\n    var _this;\n\n    _this = _Stream.call(this) || this;\n    _this.customParsers = [];\n    _this.tagMappers = [];\n    return _this;\n  }\n  /**\n   * Parses an additional line of input.\n   *\n   * @param {string} line a single line of an M3U8 file to parse\n   */\n\n\n  var _proto = ParseStream.prototype;\n\n  _proto.push = function push(line) {\n    var _this2 = this;\n\n    var match;\n    var event; // strip whitespace\n\n    line = line.trim();\n\n    if (line.length === 0) {\n      // ignore empty lines\n      return;\n    } // URIs\n\n\n    if (line[0] !== '#') {\n      this.trigger('data', {\n        type: 'uri',\n        uri: line\n      });\n      return;\n    } // map tags\n\n\n    var newLines = this.tagMappers.reduce(function (acc, mapper) {\n      var mappedLine = mapper(line); // skip if unchanged\n\n      if (mappedLine === line) {\n        return acc;\n      }\n\n      return acc.concat([mappedLine]);\n    }, [line]);\n    newLines.forEach(function (newLine) {\n      for (var i = 0; i < _this2.customParsers.length; i++) {\n        if (_this2.customParsers[i].call(_this2, newLine)) {\n          return;\n        }\n      } // Comments\n\n\n      if (newLine.indexOf('#EXT') !== 0) {\n        _this2.trigger('data', {\n          type: 'comment',\n          text: newLine.slice(1)\n        });\n\n        return;\n      } // strip off any carriage returns here so the regex matching\n      // doesn't have to account for them.\n\n\n      newLine = newLine.replace('\\r', ''); // Tags\n\n      match = /^#EXTM3U/.exec(newLine);\n\n      if (match) {\n        _this2.trigger('data', {\n          type: 'tag',\n          tagType: 'm3u'\n        });\n\n        return;\n      }\n\n      match = /^#EXTINF:?([0-9\\.]*)?,?(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'inf'\n        };\n\n        if (match[1]) {\n          event.duration = parseFloat(match[1]);\n        }\n\n        if (match[2]) {\n          event.title = match[2];\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'targetduration'\n        };\n\n        if (match[1]) {\n          event.duration = parseInt(match[1], 10);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'totalduration'\n        };\n\n        if (match[1]) {\n          event.duration = parseInt(match[1], 10);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-VERSION:?([0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'version'\n        };\n\n        if (match[1]) {\n          event.version = parseInt(match[1], 10);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-MEDIA-SEQUENCE:?(\\-?[0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'media-sequence'\n        };\n\n        if (match[1]) {\n          event.number = parseInt(match[1], 10);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-DISCONTINUITY-SEQUENCE:?(\\-?[0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'discontinuity-sequence'\n        };\n\n        if (match[1]) {\n          event.number = parseInt(match[1], 10);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'playlist-type'\n        };\n\n        if (match[1]) {\n          event.playlistType = match[1];\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'byterange'\n        };\n\n        if (match[1]) {\n          event.length = parseInt(match[1], 10);\n        }\n\n        if (match[2]) {\n          event.offset = parseInt(match[2], 10);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'allow-cache'\n        };\n\n        if (match[1]) {\n          event.allowed = !/NO/.test(match[1]);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-MAP:?(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'map'\n        };\n\n        if (match[1]) {\n          var attributes = parseAttributes(match[1]);\n\n          if (attributes.URI) {\n            event.uri = attributes.URI;\n          }\n\n          if (attributes.BYTERANGE) {\n            var _attributes$BYTERANGE = attributes.BYTERANGE.split('@'),\n                length = _attributes$BYTERANGE[0],\n                offset = _attributes$BYTERANGE[1];\n\n            event.byterange = {};\n\n            if (length) {\n              event.byterange.length = parseInt(length, 10);\n            }\n\n            if (offset) {\n              event.byterange.offset = parseInt(offset, 10);\n            }\n          }\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-STREAM-INF:?(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'stream-inf'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n\n          if (event.attributes.RESOLUTION) {\n            var split = event.attributes.RESOLUTION.split('x');\n            var resolution = {};\n\n            if (split[0]) {\n              resolution.width = parseInt(split[0], 10);\n            }\n\n            if (split[1]) {\n              resolution.height = parseInt(split[1], 10);\n            }\n\n            event.attributes.RESOLUTION = resolution;\n          }\n\n          if (event.attributes.BANDWIDTH) {\n            event.attributes.BANDWIDTH = parseInt(event.attributes.BANDWIDTH, 10);\n          }\n\n          if (event.attributes['PROGRAM-ID']) {\n            event.attributes['PROGRAM-ID'] = parseInt(event.attributes['PROGRAM-ID'], 10);\n          }\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-MEDIA:?(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'media'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-ENDLIST/.exec(newLine);\n\n      if (match) {\n        _this2.trigger('data', {\n          type: 'tag',\n          tagType: 'endlist'\n        });\n\n        return;\n      }\n\n      match = /^#EXT-X-DISCONTINUITY/.exec(newLine);\n\n      if (match) {\n        _this2.trigger('data', {\n          type: 'tag',\n          tagType: 'discontinuity'\n        });\n\n        return;\n      }\n\n      match = /^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'program-date-time'\n        };\n\n        if (match[1]) {\n          event.dateTimeString = match[1];\n          event.dateTimeObject = new Date(match[1]);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-KEY:?(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'key'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]); // parse the IV string into a Uint32Array\n\n          if (event.attributes.IV) {\n            if (event.attributes.IV.substring(0, 2).toLowerCase() === '0x') {\n              event.attributes.IV = event.attributes.IV.substring(2);\n            }\n\n            event.attributes.IV = event.attributes.IV.match(/.{8}/g);\n            event.attributes.IV[0] = parseInt(event.attributes.IV[0], 16);\n            event.attributes.IV[1] = parseInt(event.attributes.IV[1], 16);\n            event.attributes.IV[2] = parseInt(event.attributes.IV[2], 16);\n            event.attributes.IV[3] = parseInt(event.attributes.IV[3], 16);\n            event.attributes.IV = new Uint32Array(event.attributes.IV);\n          }\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-START:?(.*)$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'start'\n        };\n\n        if (match[1]) {\n          event.attributes = parseAttributes(match[1]);\n          event.attributes['TIME-OFFSET'] = parseFloat(event.attributes['TIME-OFFSET']);\n          event.attributes.PRECISE = /YES/.test(event.attributes.PRECISE);\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-out-cont'\n        };\n\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-CUE-OUT:?(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-out'\n        };\n\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      }\n\n      match = /^#EXT-X-CUE-IN:?(.*)?$/.exec(newLine);\n\n      if (match) {\n        event = {\n          type: 'tag',\n          tagType: 'cue-in'\n        };\n\n        if (match[1]) {\n          event.data = match[1];\n        } else {\n          event.data = '';\n        }\n\n        _this2.trigger('data', event);\n\n        return;\n      } // unknown tag type\n\n\n      _this2.trigger('data', {\n        type: 'tag',\n        data: newLine.slice(4)\n      });\n    });\n  }\n  /**\n   * Add a parser for custom headers\n   *\n   * @param {Object}   options              a map of options for the added parser\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {string}   options.customType   the custom type to register to the output\n   * @param {Function} [options.dataParser] function to parse the line into an object\n   * @param {boolean}  [options.segment]    should tag data be attached to the segment object\n   */\n  ;\n\n  _proto.addParser = function addParser(_ref) {\n    var _this3 = this;\n\n    var expression = _ref.expression,\n        customType = _ref.customType,\n        dataParser = _ref.dataParser,\n        segment = _ref.segment;\n\n    if (typeof dataParser !== 'function') {\n      dataParser = function dataParser(line) {\n        return line;\n      };\n    }\n\n    this.customParsers.push(function (line) {\n      var match = expression.exec(line);\n\n      if (match) {\n        _this3.trigger('data', {\n          type: 'custom',\n          data: dataParser(line),\n          customType: customType,\n          segment: segment\n        });\n\n        return true;\n      }\n    });\n  }\n  /**\n   * Add a custom header mapper\n   *\n   * @param {Object}   options\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {Function} options.map          function to translate tag into a different tag\n   */\n  ;\n\n  _proto.addTagMapper = function addTagMapper(_ref2) {\n    var expression = _ref2.expression,\n        map = _ref2.map;\n\n    var mapFn = function mapFn(line) {\n      if (expression.test(line)) {\n        return map(line);\n      }\n\n      return line;\n    };\n\n    this.tagMappers.push(mapFn);\n  };\n\n  return ParseStream;\n}(Stream);\n\n/**\n * A parser for M3U8 files. The current interpretation of the input is\n * exposed as a property `manifest` on parser objects. It's just two lines to\n * create and parse a manifest once you have the contents available as a string:\n *\n * ```js\n * var parser = new m3u8.Parser();\n * parser.push(xhr.responseText);\n * ```\n *\n * New input can later be applied to update the manifest object by calling\n * `push` again.\n *\n * The parser attempts to create a usable manifest object even if the\n * underlying input is somewhat nonsensical. It emits `info` and `warning`\n * events during the parse if it encounters input that seems invalid or\n * requires some property of the manifest object to be defaulted.\n *\n * @class Parser\n * @extends Stream\n */\n\nvar Parser =\n/*#__PURE__*/\nfunction (_Stream) {\n  _inheritsLoose(Parser, _Stream);\n\n  function Parser() {\n    var _this;\n\n    _this = _Stream.call(this) || this;\n    _this.lineStream = new LineStream();\n    _this.parseStream = new ParseStream();\n\n    _this.lineStream.pipe(_this.parseStream);\n    /* eslint-disable consistent-this */\n\n\n    var self = _assertThisInitialized(_this);\n    /* eslint-enable consistent-this */\n\n\n    var uris = [];\n    var currentUri = {}; // if specified, the active EXT-X-MAP definition\n\n    var currentMap; // if specified, the active decryption key\n\n    var _key;\n\n    var noop = function noop() {};\n\n    var defaultMediaGroups = {\n      'AUDIO': {},\n      'VIDEO': {},\n      'CLOSED-CAPTIONS': {},\n      'SUBTITLES': {}\n    }; // This is the Widevine UUID from DASH IF IOP. The same exact string is\n    // used in MPDs with Widevine encrypted streams.\n\n    var widevineUuid = 'urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed'; // group segments into numbered timelines delineated by discontinuities\n\n    var currentTimeline = 0; // the manifest is empty until the parse stream begins delivering data\n\n    _this.manifest = {\n      allowCache: true,\n      discontinuityStarts: [],\n      segments: []\n    }; // keep track of the last seen segment's byte range end, as segments are not required\n    // to provide the offset, in which case it defaults to the next byte after the\n    // previous segment\n\n    var lastByterangeEnd = 0; // update the manifest with the m3u8 entry from the parse stream\n\n    _this.parseStream.on('data', function (entry) {\n      var mediaGroup;\n      var rendition;\n      ({\n        tag: function tag() {\n          // switch based on the tag type\n          (({\n            'allow-cache': function allowCache() {\n              this.manifest.allowCache = entry.allowed;\n\n              if (!('allowed' in entry)) {\n                this.trigger('info', {\n                  message: 'defaulting allowCache to YES'\n                });\n                this.manifest.allowCache = true;\n              }\n            },\n            byterange: function byterange() {\n              var byterange = {};\n\n              if ('length' in entry) {\n                currentUri.byterange = byterange;\n                byterange.length = entry.length;\n\n                if (!('offset' in entry)) {\n                  /*\n                   * From the latest spec (as of this writing):\n                   * https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.2.2\n                   *\n                   * Same text since EXT-X-BYTERANGE's introduction in draft 7:\n                   * https://tools.ietf.org/html/draft-pantos-http-live-streaming-07#section-3.3.1)\n                   *\n                   * \"If o [offset] is not present, the sub-range begins at the next byte\n                   * following the sub-range of the previous media segment.\"\n                   */\n                  entry.offset = lastByterangeEnd;\n                }\n              }\n\n              if ('offset' in entry) {\n                currentUri.byterange = byterange;\n                byterange.offset = entry.offset;\n              }\n\n              lastByterangeEnd = byterange.offset + byterange.length;\n            },\n            endlist: function endlist() {\n              this.manifest.endList = true;\n            },\n            inf: function inf() {\n              if (!('mediaSequence' in this.manifest)) {\n                this.manifest.mediaSequence = 0;\n                this.trigger('info', {\n                  message: 'defaulting media sequence to zero'\n                });\n              }\n\n              if (!('discontinuitySequence' in this.manifest)) {\n                this.manifest.discontinuitySequence = 0;\n                this.trigger('info', {\n                  message: 'defaulting discontinuity sequence to zero'\n                });\n              }\n\n              if (entry.duration > 0) {\n                currentUri.duration = entry.duration;\n              }\n\n              if (entry.duration === 0) {\n                currentUri.duration = 0.01;\n                this.trigger('info', {\n                  message: 'updating zero segment duration to a small value'\n                });\n              }\n\n              this.manifest.segments = uris;\n            },\n            key: function key() {\n              if (!entry.attributes) {\n                this.trigger('warn', {\n                  message: 'ignoring key declaration without attribute list'\n                });\n                return;\n              } // clear the active encryption key\n\n\n              if (entry.attributes.METHOD === 'NONE') {\n                _key = null;\n                return;\n              }\n\n              if (!entry.attributes.URI) {\n                this.trigger('warn', {\n                  message: 'ignoring key declaration without URI'\n                });\n                return;\n              } // check if the content is encrypted for Widevine\n              // Widevine/HLS spec: https://storage.googleapis.com/wvdocs/Widevine_DRM_HLS.pdf\n\n\n              if (entry.attributes.KEYFORMAT === widevineUuid) {\n                var VALID_METHODS = ['SAMPLE-AES', 'SAMPLE-AES-CTR', 'SAMPLE-AES-CENC'];\n\n                if (VALID_METHODS.indexOf(entry.attributes.METHOD) === -1) {\n                  this.trigger('warn', {\n                    message: 'invalid key method provided for Widevine'\n                  });\n                  return;\n                }\n\n                if (entry.attributes.METHOD === 'SAMPLE-AES-CENC') {\n                  this.trigger('warn', {\n                    message: 'SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead'\n                  });\n                }\n\n                if (entry.attributes.URI.substring(0, 23) !== 'data:text/plain;base64,') {\n                  this.trigger('warn', {\n                    message: 'invalid key URI provided for Widevine'\n                  });\n                  return;\n                }\n\n                if (!(entry.attributes.KEYID && entry.attributes.KEYID.substring(0, 2) === '0x')) {\n                  this.trigger('warn', {\n                    message: 'invalid key ID provided for Widevine'\n                  });\n                  return;\n                } // if Widevine key attributes are valid, store them as `contentProtection`\n                // on the manifest to emulate Widevine tag structure in a DASH mpd\n\n\n                this.manifest.contentProtection = {\n                  'com.widevine.alpha': {\n                    attributes: {\n                      schemeIdUri: entry.attributes.KEYFORMAT,\n                      // remove '0x' from the key id string\n                      keyId: entry.attributes.KEYID.substring(2)\n                    },\n                    // decode the base64-encoded PSSH box\n                    pssh: decodeB64ToUint8Array(entry.attributes.URI.split(',')[1])\n                  }\n                };\n                return;\n              }\n\n              if (!entry.attributes.METHOD) {\n                this.trigger('warn', {\n                  message: 'defaulting key method to AES-128'\n                });\n              } // setup an encryption key for upcoming segments\n\n\n              _key = {\n                method: entry.attributes.METHOD || 'AES-128',\n                uri: entry.attributes.URI\n              };\n\n              if (typeof entry.attributes.IV !== 'undefined') {\n                _key.iv = entry.attributes.IV;\n              }\n            },\n            'media-sequence': function mediaSequence() {\n              if (!isFinite(entry.number)) {\n                this.trigger('warn', {\n                  message: 'ignoring invalid media sequence: ' + entry.number\n                });\n                return;\n              }\n\n              this.manifest.mediaSequence = entry.number;\n            },\n            'discontinuity-sequence': function discontinuitySequence() {\n              if (!isFinite(entry.number)) {\n                this.trigger('warn', {\n                  message: 'ignoring invalid discontinuity sequence: ' + entry.number\n                });\n                return;\n              }\n\n              this.manifest.discontinuitySequence = entry.number;\n              currentTimeline = entry.number;\n            },\n            'playlist-type': function playlistType() {\n              if (!/VOD|EVENT/.test(entry.playlistType)) {\n                this.trigger('warn', {\n                  message: 'ignoring unknown playlist type: ' + entry.playlist\n                });\n                return;\n              }\n\n              this.manifest.playlistType = entry.playlistType;\n            },\n            map: function map() {\n              currentMap = {};\n\n              if (entry.uri) {\n                currentMap.uri = entry.uri;\n              }\n\n              if (entry.byterange) {\n                currentMap.byterange = entry.byterange;\n              }\n            },\n            'stream-inf': function streamInf() {\n              this.manifest.playlists = uris;\n              this.manifest.mediaGroups = this.manifest.mediaGroups || defaultMediaGroups;\n\n              if (!entry.attributes) {\n                this.trigger('warn', {\n                  message: 'ignoring empty stream-inf attributes'\n                });\n                return;\n              }\n\n              if (!currentUri.attributes) {\n                currentUri.attributes = {};\n              }\n\n              _extends(currentUri.attributes, entry.attributes);\n            },\n            media: function media() {\n              this.manifest.mediaGroups = this.manifest.mediaGroups || defaultMediaGroups;\n\n              if (!(entry.attributes && entry.attributes.TYPE && entry.attributes['GROUP-ID'] && entry.attributes.NAME)) {\n                this.trigger('warn', {\n                  message: 'ignoring incomplete or missing media group'\n                });\n                return;\n              } // find the media group, creating defaults as necessary\n\n\n              var mediaGroupType = this.manifest.mediaGroups[entry.attributes.TYPE];\n              mediaGroupType[entry.attributes['GROUP-ID']] = mediaGroupType[entry.attributes['GROUP-ID']] || {};\n              mediaGroup = mediaGroupType[entry.attributes['GROUP-ID']]; // collect the rendition metadata\n\n              rendition = {\n                default: /yes/i.test(entry.attributes.DEFAULT)\n              };\n\n              if (rendition.default) {\n                rendition.autoselect = true;\n              } else {\n                rendition.autoselect = /yes/i.test(entry.attributes.AUTOSELECT);\n              }\n\n              if (entry.attributes.LANGUAGE) {\n                rendition.language = entry.attributes.LANGUAGE;\n              }\n\n              if (entry.attributes.URI) {\n                rendition.uri = entry.attributes.URI;\n              }\n\n              if (entry.attributes['INSTREAM-ID']) {\n                rendition.instreamId = entry.attributes['INSTREAM-ID'];\n              }\n\n              if (entry.attributes.CHARACTERISTICS) {\n                rendition.characteristics = entry.attributes.CHARACTERISTICS;\n              }\n\n              if (entry.attributes.FORCED) {\n                rendition.forced = /yes/i.test(entry.attributes.FORCED);\n              } // insert the new rendition\n\n\n              mediaGroup[entry.attributes.NAME] = rendition;\n            },\n            discontinuity: function discontinuity() {\n              currentTimeline += 1;\n              currentUri.discontinuity = true;\n              this.manifest.discontinuityStarts.push(uris.length);\n            },\n            'program-date-time': function programDateTime() {\n              if (typeof this.manifest.dateTimeString === 'undefined') {\n                // PROGRAM-DATE-TIME is a media-segment tag, but for backwards\n                // compatibility, we add the first occurence of the PROGRAM-DATE-TIME tag\n                // to the manifest object\n                // TODO: Consider removing this in future major version\n                this.manifest.dateTimeString = entry.dateTimeString;\n                this.manifest.dateTimeObject = entry.dateTimeObject;\n              }\n\n              currentUri.dateTimeString = entry.dateTimeString;\n              currentUri.dateTimeObject = entry.dateTimeObject;\n            },\n            targetduration: function targetduration() {\n              if (!isFinite(entry.duration) || entry.duration < 0) {\n                this.trigger('warn', {\n                  message: 'ignoring invalid target duration: ' + entry.duration\n                });\n                return;\n              }\n\n              this.manifest.targetDuration = entry.duration;\n            },\n            totalduration: function totalduration() {\n              if (!isFinite(entry.duration) || entry.duration < 0) {\n                this.trigger('warn', {\n                  message: 'ignoring invalid total duration: ' + entry.duration\n                });\n                return;\n              }\n\n              this.manifest.totalDuration = entry.duration;\n            },\n            start: function start() {\n              if (!entry.attributes || isNaN(entry.attributes['TIME-OFFSET'])) {\n                this.trigger('warn', {\n                  message: 'ignoring start declaration without appropriate attribute list'\n                });\n                return;\n              }\n\n              this.manifest.start = {\n                timeOffset: entry.attributes['TIME-OFFSET'],\n                precise: entry.attributes.PRECISE\n              };\n            },\n            'cue-out': function cueOut() {\n              currentUri.cueOut = entry.data;\n            },\n            'cue-out-cont': function cueOutCont() {\n              currentUri.cueOutCont = entry.data;\n            },\n            'cue-in': function cueIn() {\n              currentUri.cueIn = entry.data;\n            }\n          })[entry.tagType] || noop).call(self);\n        },\n        uri: function uri() {\n          currentUri.uri = entry.uri;\n          uris.push(currentUri); // if no explicit duration was declared, use the target duration\n\n          if (this.manifest.targetDuration && !('duration' in currentUri)) {\n            this.trigger('warn', {\n              message: 'defaulting segment duration to the target duration'\n            });\n            currentUri.duration = this.manifest.targetDuration;\n          } // annotate with encryption information, if necessary\n\n\n          if (_key) {\n            currentUri.key = _key;\n          }\n\n          currentUri.timeline = currentTimeline; // annotate with initialization segment information, if necessary\n\n          if (currentMap) {\n            currentUri.map = currentMap;\n          } // prepare for the next URI\n\n\n          currentUri = {};\n        },\n        comment: function comment() {// comments are not important for playback\n        },\n        custom: function custom() {\n          // if this is segment-level data attach the output to the segment\n          if (entry.segment) {\n            currentUri.custom = currentUri.custom || {};\n            currentUri.custom[entry.customType] = entry.data; // if this is manifest-level data attach to the top level manifest object\n          } else {\n            this.manifest.custom = this.manifest.custom || {};\n            this.manifest.custom[entry.customType] = entry.data;\n          }\n        }\n      })[entry.type].call(self);\n    });\n\n    return _this;\n  }\n  /**\n   * Parse the input string and update the manifest object.\n   *\n   * @param {string} chunk a potentially incomplete portion of the manifest\n   */\n\n\n  var _proto = Parser.prototype;\n\n  _proto.push = function push(chunk) {\n    this.lineStream.push(chunk);\n  }\n  /**\n   * Flush any remaining input. This can be handy if the last line of an M3U8\n   * manifest did not contain a trailing newline but the file has been\n   * completely received.\n   */\n  ;\n\n  _proto.end = function end() {\n    // flush any buffered input\n    this.lineStream.push('\\n');\n  }\n  /**\n   * Add an additional parser for non-standard tags\n   *\n   * @param {Object}   options              a map of options for the added parser\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {string}   options.type         the type to register to the output\n   * @param {Function} [options.dataParser] function to parse the line into an object\n   * @param {boolean}  [options.segment]    should tag data be attached to the segment object\n   */\n  ;\n\n  _proto.addParser = function addParser(options) {\n    this.parseStream.addParser(options);\n  }\n  /**\n   * Add a custom header mapper\n   *\n   * @param {Object}   options\n   * @param {RegExp}   options.expression   a regular expression to match the custom header\n   * @param {Function} options.map          function to translate tag into a different tag\n   */\n  ;\n\n  _proto.addTagMapper = function addTagMapper(options) {\n    this.parseStream.addTagMapper(options);\n  };\n\n  return Parser;\n}(Stream);\n\nexport { LineStream, ParseStream, Parser };\n","import { Parser } from 'm3u8-parser'\n\nconst downloadM3U8 = async (url: string) => {\n  return fetch(url).then(response => {\n    if (!response.ok) {\n      throw Error(response.statusText)\n    }\n\n    return response.text()\n  })\n}\n\nconst parseM3U8 = (m3u8: string) => {\n  const parser = new Parser()\n  parser.push(m3u8)\n  parser.end()\n  return parser.manifest\n}\n\nconst downloadSegments = async (manifest: any): Promise<ArrayBuffer[]> => {\n  const urls = manifest.segments.map(segment => segment.uri)\n  const promises: Promise<ArrayBuffer>[] = urls.map(async url => await fetch(url).then(response => {\n    if (!response.ok) {\n      throw Error(response.statusText)\n    }\n\n    if (response.headers.get('Content-Type').toLowerCase() === 'audio/mpeg') {\n      throw Error('Got invalid Content-Type while downloading HLS segments: ' + response.headers.get('Content-Type'))\n    }\n\n    return response.arrayBuffer()\n  }))\n  return await Promise.all(promises)\n}\n\ninterface DownloadOptions {\n  url?: string,\n  m3u8?: string\n}\n\nexport const download = async (options: DownloadOptions) => {\n  let m3u8\n  if (options.url) {\n    m3u8 = await downloadM3U8(options.url)\n  }\n  if (!options.url && !options.m3u8) {\n    throw new Error('No url or m3u8 string specified')\n  }\n  const parsed = parseM3U8(m3u8)\n  if (parsed.segments.length === 0) {\n    throw new Error('Got an invalid M3U8 file, check the provided URL or m3u8 string is valid')\n  }\n  const segments = await downloadSegments(parsed)\n  const blob = new Blob(segments)\n  return blob\n}\n\nexport const downloadToFile = async (options: DownloadOptions, filename: string) => {\n  const blob = await download(options)\n  const URL = window.URL || window.webkitURL\n  const u = URL.createObjectURL(blob)\n  const a = document.createElement('a')\n  a.style.display = 'none'\n  a.href = u\n  a.download = filename\n  document.body.appendChild(a)\n  a.click()\n  window.URL.revokeObjectURL(u)\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(607);\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => module['default'] :\n\t\t() => module;\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}